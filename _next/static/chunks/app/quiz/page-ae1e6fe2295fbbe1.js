(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[705],{5946:function(e,t,r){Promise.resolve().then(r.bind(r,7513))},7513:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var n=r(7437),s=r(2265);function a(e){let{children:t}=e;return(0,n.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,n.jsx)("div",{className:"py-6 md:py-8",children:t})})}function i(e){let{modes:t,value:r,onChange:s}=e;return(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("div",{className:"text-sm text-gray-700 mb-1",children:"Режим"}),(0,n.jsx)("select",{className:"select",value:r,onChange:e=>s(e.target.value),children:Object.entries(t).map(e=>{let[t,r]=e;return(0,n.jsxs)("option",{value:t,children:[r.name," ","ready"!==r.status?"(soon)":""]},t)})})]})}function l(e){let{sets:t,value:r,onChange:s}=e;return(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("div",{className:"text-sm text-gray-700 mb-1",children:"Набір слів"}),(0,n.jsx)("select",{className:"select",value:r,onChange:e=>s(e.target.value),children:t.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))})]})}var o=r(2464);async function c(e,t){if(!e)try{return JSON.parse(localStorage.getItem("guest:progress:".concat(t))||"{}")}catch(e){return{}}let r=(0,o.e)(),{data:n,error:s}=await r.from("user_progress").select("word_id, short_memory").eq("uid",e).eq("set_id",t);if(s)return console.error("getSetProgress error",s),{};let a={};return(n||[]).forEach(e=>{var t;a[e.word_id]={shortMemory:null!==(t=e.short_memory)&&void 0!==t?t:0}}),a}async function u(e,t,r,n){var s;if(!e){let e="guest:progress:".concat(t),s=(()=>{try{return JSON.parse(localStorage.getItem(e)||"{}")}catch(e){return{}}})();s[r]={...s[r]||{},...n};try{localStorage.setItem(e,JSON.stringify(s))}catch(e){}return}let a=(0,o.e)(),{error:i}=await a.from("user_progress").upsert({uid:e,set_id:t,word_id:r,short_memory:null!==(s=n.shortMemory)&&void 0!==s?s:0},{onConflict:"uid,word_id"});i&&console.error("saveWordProgress error",i)}async function d(e,t){var r,n;if(!e)try{return JSON.parse(localStorage.getItem("guest:stats:".concat(t))||"{}")}catch(e){return{attempts:0,correct:0}}let s=(0,o.e)(),{data:a,error:i}=await s.from("user_set_stats").select("attempts, correct").eq("uid",e).eq("set_id",t).maybeSingle();return i||!a?{attempts:0,correct:0}:{attempts:null!==(r=a.attempts)&&void 0!==r?r:0,correct:null!==(n=a.correct)&&void 0!==n?n:0}}async function m(e,t,r){if(!e){try{localStorage.setItem("guest:stats:".concat(t),JSON.stringify(r))}catch(e){}return}let n=(0,o.e)(),{error:s}=await n.from("user_set_stats").upsert({uid:e,set_id:t,attempts:r.attempts,correct:r.correct},{onConflict:"uid,set_id"});s&&console.error("saveSetStats error",s)}var f=r(5691);function h(e){let{value:t}=e;return(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[(0,n.jsx)("span",{children:"Прогрес"}),(0,n.jsxs)("span",{children:[t,"%"]})]}),(0,n.jsx)("div",{className:"progress",children:(0,n.jsx)("div",{className:"progress-bar",style:{width:"".concat(t,"%")}})})]})}var v=r(8776);let x={education:{name:"Education",component:function(e){let{setDef:t}=e,[r,a]=(0,s.useState)(null),[i,l]=(0,s.useState)(()=>t.words.map(e=>({...e,shortMemory:0}))),[v,x]=(0,s.useState)(null),[g,w]=(0,s.useState)(""),[y,p]=(0,s.useState)(0),[j,N]=(0,s.useState)(0),[b,S]=(0,s.useState)([]),[_,M]=(0,s.useState)(null),C=(0,s.useRef)(performance.now());(0,s.useEffect)(()=>{(0,o.e)().auth.getUser().then(e=>{var t,r;let{data:n}=e;return a(null!==(r=null===(t=n.user)||void 0===t?void 0:t.id)&&void 0!==r?r:null)})},[]),(0,s.useEffect)(()=>{let e=!0;return(async()=>{var n,s;let[a,i]=await Promise.all([c(r,t.id),d(r,t.id)]),o=t.words.map(e=>{var t,r;return{...e,shortMemory:null!==(r=null===(t=a[e.id])||void 0===t?void 0:t.shortMemory)&&void 0!==r?r:0}});if(!e)return;l(o),p(null!==(n=i.attempts)&&void 0!==n?n:0),N(null!==(s=i.correct)&&void 0!==s?s:0);let u=o.filter(e=>!(0,f.tm)(e)&&!b.includes(e.id));x(u.length?(0,f.CT)(u):null),C.current=performance.now()})(),()=>{e=!1}},[r,t.id]);let I=(0,s.useMemo)(()=>v?Array.isArray(v.answer)?v.answer:[v.answer]:[],[v]);async function J(e){let n=i.map(t=>{var r;return v&&t.id===v.id?{...t,shortMemory:e?(null!==(r=t.shortMemory)&&void 0!==r?r:0)+1:0}:t});if(l(n),v){var s,a;await u(r,t.id,v.id,{shortMemory:null!==(a=null===(s=n.find(e=>e.id===v.id))||void 0===s?void 0:s.shortMemory)&&void 0!==a?a:0})}let o=v?[...b,v.id].slice(-5):b;S(o);let c=n.filter(e=>!(0,f.tm)(e)&&!o.includes(e.id));0===c.length&&(c=n.filter(e=>!(0,f.tm)(e))),x(c.length?(0,f.CT)(c):null)}function k(){if(!v)return;let e=g.trim().toLowerCase(),n=I.some(t=>t.trim().toLowerCase()===e);M(n?null:"Правильна відповідь: ".concat(I.join(", "))),p(e=>{let s=e+1;return m(r,t.id,{attempts:s,correct:n?j+1:j}),s}),N(e=>{let s=e+(n?1:0);return m(r,t.id,{attempts:y+1,correct:s}),s}),w(""),J(n),C.current=performance.now()}let O=(0,f.J8)(i);return(0,n.jsxs)("div",{className:"grid gap-6",children:[_&&(0,n.jsx)("div",{className:"text-sm text-red-600",children:_}),(0,n.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,n.jsxs)("div",{className:"badge",children:["Attempts: ",y]}),(0,n.jsxs)("div",{className:"badge",children:["Correct: ",j]}),(0,n.jsx)("div",{className:"ml-auto w-full md:w-64",children:(0,n.jsx)(h,{value:O})})]}),(0,n.jsx)("div",{className:"card p-6",children:v?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Підказка"}),(0,n.jsx)("div",{className:"text-2xl md:text-3xl font-semibold",children:v.hint}),(0,n.jsxs)("div",{className:"mt-4 flex items-center gap-3",children:[(0,n.jsx)("input",{className:"input",placeholder:"Введіть відповідь...",value:g,onChange:e=>w(e.target.value),onKeyDown:e=>{"Enter"===e.key&&k()},autoFocus:!0}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:k,children:"Перевірити"})]})]}):(0,n.jsxs)("div",{className:"text-gray-700",children:["Усі слова в наборі позначені як ",(0,n.jsx)("b",{children:"вивчені"})," (shortMemory > 15). Обери інший набір або зменш поріг."]})})]})},status:"ready"}};function g(){let[e,t]=(0,s.useState)([]),[r,o]=(0,s.useState)(void 0),[c,u]=(0,s.useState)("education"),d=e.find(e=>e.id===r),m=x[c].component;return(0,s.useEffect)(()=>{(async()=>{let e=await (0,v.oA)();if(e.length){var r;t(e),o(null===(r=e[0])||void 0===r?void 0:r.id)}})()},[]),(0,n.jsxs)(a,{children:[(0,n.jsxs)("header",{className:"container-nice flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[(0,n.jsx)("div",{children:(0,n.jsx)("h1",{className:"text-2xl md:text-3xl font-semibold tracking-tight",children:"Quiz Trainer"})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 w-full md:w-auto",children:[(0,n.jsx)(l,{sets:e,value:r,onChange:o}),(0,n.jsx)(i,{modes:x,value:c,onChange:e=>u(e)}),(0,n.jsx)("a",{className:"btn btn-ghost",href:"/quiz/manage",children:"Керувати наборами"})]})]}),(0,n.jsx)("main",{className:"container-nice mt-6",children:(0,n.jsx)("div",{className:"card p-4 md:p-6",children:d?(0,n.jsx)(m,{setDef:d}):(0,n.jsx)("div",{className:"text-gray-700",children:"Немає вибраного набору. Створіть або оберіть набір."})})})]})}},8776:function(e,t,r){"use strict";r.d(t,{G7:function(){return o},Jx:function(){return d},Or:function(){return m},_z:function(){return i},cZ:function(){return l},kB:function(){return f},oA:function(){return a},rI:function(){return h},wH:function(){return c},x8:function(){return u}});var n=r(2464);function s(e){return{id:e.id,hint:e.hint,answer:Array.isArray(e.answers)?e.answers:"string"==typeof e.answers?[e.answers]:[],shortMemory:0}}async function a(){let e=(0,n.e)(),{data:t,error:r}=await e.from("sets").select("id, name, words:words(id, hint, answers)").order("name",{ascending:!0});return r?[]:(t||[]).map(e=>({id:e.id,name:e.name,words:(e.words||[]).map(s)}))}async function i(){let e=(0,n.e)(),{data:t,error:r}=await e.from("sets").select("id, name").order("name",{ascending:!0});return r?[]:t}async function l(e){let t=(0,n.e)(),{data:r,error:a}=await t.from("sets").select("id, name, words:words(id, hint, answers)").eq("id",e).maybeSingle();return a||!r?null:{id:r.id,name:r.name,words:(r.words||[]).map(s)}}async function o(e,t,r){let s=(0,n.e)();await s.from("words").insert({set_id:e,hint:t,answers:r})}async function c(e,t){if(!t.length)return;let r=(0,n.e)();await r.from("words").insert(t.map(t=>({set_id:e,hint:t.hint,answers:t.answers})))}async function u(e){let t=(0,n.e)();await t.from("words").delete().eq("id",e)}async function d(e){let t=(0,n.e)();await t.from("sets").insert({name:e})}async function m(e,t){let r=(0,n.e)();await r.from("sets").update({name:t}).eq("id",e)}async function f(e){let t=(0,n.e)();await t.from("sets").delete().eq("id",e)}async function h(e,t){let r=(0,n.e)();await r.from("words").update(t).eq("id",e)}},5691:function(e,t,r){"use strict";r.d(t,{$B:function(){return n},CT:function(){return a},J8:function(){return i},tm:function(){return s}});let n=15;function s(e){var t;return(null!==(t=e.shortMemory)&&void 0!==t?t:0)>n}function a(e){var t;if(!e.length)return null;let r=Math.min(...e.map(e=>{var t;return null!==(t=e.shortMemory)&&void 0!==t?t:0})),n=e.filter(e=>{var t;return(null!==(t=e.shortMemory)&&void 0!==t?t:0)===r});return null!==(t=n[Math.floor(Math.random()*n.length)])&&void 0!==t?t:null}function i(e){return e.length?Math.round(e.filter(s).length/e.length*100):0}},2464:function(e,t,r){"use strict";r.d(t,{e:function(){return s}});var n=r(5570);let s=()=>(0,n.createBrowserClient)("https://wlyskuyqdvvzivgrssyd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndseXNrdXlxZHZ2eml2Z3Jzc3lkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxOTQwODcsImV4cCI6MjA3MDc3MDA4N30.PuRk6yZtgrMMdsVYzgWkabvlvtuLwv6PKD47m8aowYA")}},function(e){e.O(0,[570,971,23,744],function(){return e(e.s=5946)}),_N_E=e.O()}]);